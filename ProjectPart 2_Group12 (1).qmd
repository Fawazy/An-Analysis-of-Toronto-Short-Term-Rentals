---
title: "An Analysis of Toronto Short-Term Rentals - Part 2"
author:
  - name: "Group 12"
  - name: "Yiping Liu (ID: 0870378)"
  - name: "Dmitry Mishchenko (ID: 0512776)"
  - name: "Mohammed Muzammil (ID: 0885649)"
  - name: "Fawaz Yahya (ID: 0867165)"
date: "2025-11-15"
format: 
  pdf:
    number-sections: true
    toc: false
    fontsize: 11pt
    geometry:
      - margin=1in
    include-in-header:
       text: |
         \usepackage{float}
         \floatplacement{table}{H}
         \floatplacement{figure}{H}
         \usepackage[hyphens]{url}
         \usepackage{url}  
         \urlstyle{tt} 
         \usepackage[none]{hyphenat} 
         \usepackage{ragged2e}
         \usepackage{threeparttable}
    documentclass: article
title-block-style: default
title-block-categories: false
title-block-banner: false
execute:
  echo: false
  message: false
  warning: false
bibliography: references.bib
csl: ieee.csl
link-citations: true
---

\thispagestyle{empty}

```{r}
#| label: setup
#| echo: false
#| message: false
#| warning: false

library(tidyverse)
library(janitor)
library(knitr)
library(kableExtra)
library(patchwork)
library(infer)
library(broom)
library(rstatix)
library(psych)
library(ggplot2)

theme_set(theme_bw()) 
```


\newpage

# Background

## Brief Dataset Reminder

This project uses the **Toronto Airbnb listings dataset** downloaded from *Inside Airbnb*[@inside_airbnb] on **September 11, 2025**. Inside Airbnb is a non-commercial project that regularly scrapes and curates data to support community and policy discussions about short-term rental impacts.

The original dataset contained **79 variables** describing listing attributes, host details, reviews, and availability.  After initial wrangling and filtering, we retained the most relevant variables for exploring **factors that predict nightly price**.  Variable selection was guided by prior research [@cetinkaya2021] [@airbnb_price_factors], focusing on location, accommodations, and review ratings.


```{r}
#| label: tbl-variable-dictionary
#| echo: false
#| tbl-cap: "Key variables used in the analysis."

var_dict_cat <- tribble(
  ~Variable, ~Description, ~Type,
  "price", "Nightly listing price (CAD)", "Numeric (continuous)",
  "neigh_group", "Neighbourhood demand group (High/Medium/Low)", "Categorical (ordinal)",
  "accommodates", "Maximum number of guests accommodated", "Numeric (integer)",
  "review_scores_rating", "Overall rating score (0–5)", "Numeric (continuous)"
)

var_dict_cat |>
  kable(
    col.names = c("Variable", "Description", "Type"),
    align = c("l", "l", "l"),
    booktabs = TRUE
  ) |>
  kable_styling(
    full_width = FALSE,
    position = "center",
    font_size = 11,
    bootstrap_options = c("condensed", "responsive"),
    latex_options = c("hold_position", "striped")
  ) |>
  column_spec(1, width = "3cm") |>
  column_spec(2, width = "10cm") |>
  column_spec(3, width = "3cm") |>
  add_footnote(
    label = "Note: 'neigh_group' is derived from 'neighbourhood_cleansed' and reviews_per_month (proxy for demand).",
    notation = "none"
  )
```

```{r}
#| echo: false
#| message: false
#| warning: false

airbnb <- read_csv("listings.csv")

DataKeyVariable <- airbnb |> select(price,neighbourhood_cleansed,
                                    accommodates,
                                    review_scores_rating, 
                                    reviews_per_month)

n_raw <- nrow(DataKeyVariable)

# Preliminary Subset Review for NAs, not included in the report
#DataKeyVariable |> summarise(across(everything(), ~ sum(is.na(.x)))) |> 
  #kable(col.names = c("Price", "Neighborhood", "Accomodates","Score Rating",
                    #"Monthly Reviews"),caption = "Table 2: Summary of Key Variables and Missing Values")  
```

## Preliminary Subset Review

A review of the raw dataset identified several issues requiring cleaning before meaningful exploratory analysis.

First, the `price` variable is stored as character data and contains currency symbols (e.g., “$”) as well as missing values. These must be converted into a numeric format to allow proper summary statistics and visualization.
Second, the review-related variables (`reviews_per_month` and `review_scores_rating`) contain substantial missingness. These missing values largely reflect listings with no reviews rather than data entry errors. For modelling active listings, we remove rows with missing values in these fields rather than imputing replacement values.

Finally, the `neighbourhood_cleansed` field contains roughly 140 categories, which is too granular to include directly in visualizations or regression models. A simplified grouping variable is therefore required.

These issues motivate the cleaning and transformation steps in the following sections, where we construct a consistent dataset suitable for regression and hypothesis testing.



```{r}
#| label: data-cleaning
#| echo: false
#| message: false
#| warning: false
#| include: false

# clean and transform variables
DataFiltered <- DataKeyVariable |>
  mutate(
    price = parse_number(price)
  ) |>
  filter(
    !is.na(price),
    !is.na(review_scores_rating),
    !is.na(reviews_per_month),
    !is.na(neighbourhood_cleansed)
  )

```


## Summary Statistics

```{r}
#| label: descriptive-stats
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Descriptive statistics for numeric variables (mean, SD, median, min, max)."

DataFiltered |>
  select(where(is.numeric)) |>
  describe() |>
  as.data.frame() |>
  rownames_to_column("Variable") |>
  select(
    Variable,
    Mean   = mean,
    SD     = sd,
    Median = median,
    Min    = min,
    Max    = max
  ) |>
  mutate(across(c(Mean, SD, Median, Min, Max), ~ round(.x, 2))) |>
  kable(
    col.names = c("Variable", "Mean", "SD", "Median", "Min", "Max"),
    booktabs = TRUE
  ) |>
  kable_styling(full_width = FALSE, position = "center")

```



```{r}
#| label: tbl-exout
#| echo: false
#| message: false
#| warning: false
#| include: false

numeric_df <- DataFiltered |>
  select(price, accommodates, review_scores_rating, reviews_per_month)

# outlier count - not included in the report
outlier_list <- map(names(numeric_df), ~ {
  var_sym <- sym(.x)

  numeric_df |>
    identify_outliers(!!var_sym) |>
    summarise(
      Variable         = .x,
      Total_outliers   = sum(is.outlier,  na.rm = TRUE),
      Extreme_outliers = sum(is.extreme,  na.rm = TRUE)
    )
})

```

The summary statistics highlight several data quality and distributional issues across key variables.

**Price** — The mean nightly price is approximately **\$187 ($SD ≈ 289.82$)** , with a median of about **$139**. Extreme outliers (up to around **$16,203**) pull the mean sharply to the right, creating a strong positive skew.

**Accommodates** — The average listing accommodates roughly **3.31 guests ($SD ≈ 2.07$)** with a median of **3**. The maximum value of **16** represents an extreme outlier, again indicating right-skewed data.

**Review Scores Rating** — The mean rating is about **4.79 ($SD ≈ 0.37$)** with a median near **4.9**, on a **0–5 scale**. Ratings are heavily concentrated toward the high end.

**Reviews per Month** — The mean is roughly **1.65 ($SD ≈ 1.9)$** with a median of about **0.97**. A maximum of **35.66** indicates the presence of strong outliers and a long right tail.

**Neighbourhood** — This variable contains approximately **140 categories**, making it too granular for regression or clear visualization without consolidation.

Overall, the summary statistics reveal several issues that could distort both visualization and modelling if left unaddressed:
- the presence of extreme outliers,  
- and a subset of listings with **zero monthly reviews or zero ratings**, which in most cases are inactive/invalid lsitings.

These observations motivate the cleaning and transformation steps described in the next section.For this project, the cleaning steps were chosen to simplify the analysis. In practice, decisions like removing outliers or filtering low-activity listings require careful justification. For a real-world analysis, we would evaluate the impact of these removals, test alternative handling methods.

```{r}
#| label: tbl-wrng
#| tbl-cap: "Numeric variable data wrangling and outlier removal."
#| echo: false
#| warning: false
#| message: false

# add row index
DataFiltered <- DataFiltered |>
  mutate(.row = row_number())

# remove impossible / uninformative values
DataFiltered <- DataFiltered |>
  filter(
    price > 0,
    reviews_per_month > 0,
    review_scores_rating > 0
  )

# identify extreme outliers for each numeric variable
price_out <- DataFiltered |>
  identify_outliers(price)

acc_out <- DataFiltered |>
  identify_outliers(accommodates)

rating_out <- DataFiltered |>
  identify_outliers(review_scores_rating)

rpm_out <- DataFiltered |>
  identify_outliers(reviews_per_month)

price_extreme  <- price_out  |> filter(is.extreme) |> pull(.row)
acc_extreme    <- acc_out    |> filter(is.extreme) |> pull(.row)
rating_extreme <- rating_out |> filter(is.extreme) |> pull(.row)
rpm_extreme    <- rpm_out    |> filter(is.extreme) |> pull(.row)

# combine all row indices to remove
extreme_ids <- unique(c(price_extreme, acc_extreme, rating_extreme, rpm_extreme))

# remove rows with extreme outliers and drop helper column
DataClean <- DataFiltered |>
  filter(!.row %in% extreme_ids) |>
  select(-.row)

n_clean <- nrow(DataClean)

```


```{r}
#| label: tbl-grpcollaps
#| tbl-cap: "Neighbourhood variable collapsed into low, middle, and high demand groups."
#| echo: false
#| warning: false
#| message: false

# compute mean monthly reviews per neighbourhood
neigh_demand <- DataClean |>
  group_by(neighbourhood_cleansed) |>
  summarise(
    mean_rpm = mean(reviews_per_month, na.rm = TRUE),
    .groups  = "drop"
  )

# 20th and 80th percentile thresholds
q20 <- quantile(neigh_demand$mean_rpm, probs = c(0.20, 0.80), na.rm = TRUE)

# classify neighbourhoods into Low / Middle / High demand groups
neigh_demand <- neigh_demand |>
  mutate(
    neigh_group = case_when(
      mean_rpm >= q20[2] ~ "High",
      mean_rpm <= q20[1] ~ "Low",
      TRUE               ~ "Middle"
    )
  )

# merge group back into main dataset
DataClean <- DataClean |>
  left_join(
    neigh_demand |> select(neighbourhood_cleansed, neigh_group),
    by = "neighbourhood_cleansed"
  )

```

# Data Wrangling

Several steps were taken to prepare the dataset for exploratory data analysis (EDA) and modelling.

- **Numeric conversion** – `price` was converted from character to numeric by removing currency symbols, and all key quantitative variables (`price`, `accommodates`, `review_scores_rating`, `reviews_per_month`) were stored as numeric types.

- **Filtering impossible or uninformative values** – Listings with `price = 0`(invalid price), `reviews_per_month = 0`, or `review_scores_rating = 0`(new/invalid listings, don't contribute to our analysis) were removed. 

- **Extreme outlier removal** – Extreme outliers (identified using the `identify_outliers()` function and a 3×IQR rule) were removed from `price`, `accommodates`, `review_scores_rating`, and `reviews_per_month`. This reduces the influence of a small number of extreme listings on summary statistics and regression estimates.

- **Neighbourhood grouping** – The original `neighbourhood_cleansed` variable contains approximately 140 distinct neighbourhoods. This level of granularity makes it difficult to include directly in regression models or to summarize clearly in a single figure.
To create a more interpretable location variable, neighbourhoods were grouped using average monthly review activity (`reviews_per_month`) as a proxy for local demand:
- For each neighbourhood, we computed the mean number of monthly reviews.
- Neighbourhoods in the bottom 20% of this distribution were classified as **Low** demand.
- Neighbourhoods in the top 20% were classified as **High** demand.
- The remaining 60% were classified as **Middle** demand.
This yields a three-level categorical variable (`neigh_group` = Low, Middle, High) that captures broad demand differences while avoiding the noise of a high-cardinality factor.

After these steps, the working dataset was reduced from `r n_raw` to `r n_clean` observations, providing a cleaner, more homogeneous sample for the EDA and regression analysis.

# Data visualization

```{r}
#| label: fig-eda
#| fig-cap: "Exploratory data visualizations: nightly price (top-left), review scores (top-right), accommodates (bottom-left), and price by neighbourhood demand group (bottom-right)."
#| echo: false
#| warning: false
#| message: false

# nightly price
EDA_P <- DataClean |>
  ggplot(aes(price)) +
  geom_histogram(bins = 100, fill = "grey70") +
  geom_vline(aes(xintercept = mean(price, na.rm = TRUE)),
             color = "red", linewidth = 1) +
  geom_vline(aes(xintercept = median(price, na.rm = TRUE)),
             color = "blue", linewidth = 1) +
  labs(
    title = "Nightly Price Distribution",
    x = "Price (CAD)",
    y = "Frequency"
  )

# review scores rating
EDA_R <- DataClean |>
  ggplot(aes(review_scores_rating)) +
  geom_histogram(bins = 20, fill = "grey70") +
  geom_vline(aes(xintercept = mean(review_scores_rating, na.rm = TRUE)),
             color = "red", linewidth = 1) +
  geom_vline(aes(xintercept = median(review_scores_rating, na.rm = TRUE)),
             color = "blue", linewidth = 1) +
  labs(
    title = "Review Scores Rating Distribution",
    x = "Review score",
    y = "Frequency"
  )

# accommodates
EDA_A <- DataClean |>
  ggplot(aes(accommodates)) +
  geom_histogram(bins = 10, fill = "grey70") +
  geom_vline(aes(xintercept = mean(accommodates, na.rm = TRUE)),
             color = "red", linewidth = 1) +
  geom_vline(aes(xintercept = median(accommodates, na.rm = TRUE)),
             color = "blue", linewidth = 1) +
  labs(
    title = "Accommodates Distribution",
    x = "Guests accommodated",
    y = "Frequency"
  )

# price by neighbourhood group
EDA_N <- DataClean |>
  ggplot(aes(neigh_group, price)) +
  geom_boxplot(fill = "grey70") +
  labs(
    title = "Price by Neighbourhood Demand Group",
    x = "Neighbourhood demand group",
    y = "Price (CAD)"
  )

(EDA_P | EDA_R) /
(EDA_A | EDA_N)

```
# Summary of Exploratory Data Visualizations

As shown in **@fig-eda**, four key exploratory plots summarize the cleaned dataset:  
nightly price (top-left), review scores (top-right), accommodates (bottom-left), and price by neighbourhood demand group (bottom-right).

### Price Per Night Distribution
In the **top-left panel of @fig-eda**, the price distribution is **right-skewed**, with most listings priced below approximately **$200 per night**. A long tail shows a small number of expensive listings above **$400–$600**. The **mean** (red line) lies noticeably above the **median** (blue line), confirming that high-priced outliers pull the average upward. The distribution is **unimodal**, with a single primary peak.

### Accommodates Distribution
The **bottom-left panel of @fig-eda** shows that the number of guests a listing can accommodate is **clustered around 2–4**, with a sharp decline for larger properties. The mean and median are close, suggesting a nearly symmetric distribution, though a few listings that accommodate more than **6–8 guests** stretch the right tail slightly. This variable is also **unimodal**, with one clear peak.

### Review Scores Rating Distribution
The **top-right panel of @fig-eda** indicates that review scores are **heavily concentrated at the high end**, mostly between **4.7 and 4.9**. The mean and median nearly overlap, indicating consistently high guest satisfaction and very few poorly rated listings. The distribution is **unimodal**, with a single dense cluster of high ratings.

### Price Distribution by Neighbourhood Group
The **bottom-right panel of @fig-eda** compares prices across neighbourhood demand groups. Median prices differ modestly: **High-demand** areas exhibit slightly higher median prices and greater variability, with more high-priced outliers, while **Low** and **Medium-demand** areas have tighter distributions centered at lower prices.

The differences in median prices across demand groups are present but not dramatic. High-demand neighbourhoods show more price variability and a thicker upper tail, while Low- and Middle-demand areas have more concentrated price distributions. These patterns suggest that neighbourhood-level demand is associated with both pricing and listing characteristics, which is relevant for understanding how short-term rental activity clusters geographically. Such clustering may have implications for local housing markets and for policy efforts aimed at managing STR concentration in specific parts of the city.


```{r}
#| label: fig-bivariate
#| fig-cap: "Key bivariate relationships relevant to the regression model: price vs accommodates (left) and price vs review rating (right)."
#| echo: false
#| message: false
#| warning: false

# price vs accommodates
P_A <- DataClean |>
  ggplot(aes(accommodates, price)) +
  geom_point(alpha = 0.25, size = 1) +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(
    title = "Price vs Accommodates",
    x     = "Accommodates",
    y     = "Price (CAD)"
  )

# price vs review scores rating
P_R <- DataClean |>
  ggplot(aes(review_scores_rating, price)) +
  geom_point(alpha = 0.25, size = 1) +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(
    title = "Price vs Review Scores Rating",
    x     = "Review Score (0–5)",
    y     = "Price (CAD)"
  )

P_A | P_R

```

## Additional Exploration of Key Relationships

@fig-bivariate shows two key relationships directly relevant to the proposed regression model.

**Price vs Accommodates** - There is a clear and roughly linear upward trend: listings that accommodate more guests tend to charge higher nightly prices. This supports including `accommodates` as a predictor in the regression model.
**Price vs Review Scores Rating** - The relationship is weaker and more scattered, but there is still a slight upward slope. Higher-rated listings tend to have somewhat higher prices, indicating that `review_scores_rating` may have a modest predictive effect.
These relationships help justify the structure of the regression model and confirm that linear modelling is appropriate for the predictors under consideration.

# Research Questions

### Part 1: Regression (Population Parameters)

**Question:**  
How strongly do a property’s accommodation capacity, review rating, and neighbourhood demand group predict nightly price?

The population regression model is:
$$
E(Y) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3
$$

where:  
- $Y$ = nightly price  
- $X_1$ = accommodates  
- $X_2$ = review\_scores\_rating  
- $X_3$ = neighbourhood group (Low, Middle, High)

The primary interest is whether the coefficients differ from zero:

$$
H_0: \beta_1 = 0
H_0: \beta_2 = 0
H_0: \beta_3 = 0
$$
Rejection indicates that the predictor contributes meaningfully to explaining price.
.

### Part 2: Hypothesis Test (Population Means)

**Question:**  
Do High-demand and Low-demand neighbourhoods differ in either average accommodation capacity or average review rating?

Define the population means:  

$\mu_{A,High}$, $\mu_{A,Low}$: mean accommodates  
$\mu_{R,High}$, $\mu_{R,Low}$: mean review score rating

Null hypotheses:  
$$
H_{0,1}: \mu_{A,High} = \mu_{A,Low}
H_{0,2}: \mu_{R,High} = \mu_{R,Low}
$$
Alternative hypotheses: 
$$
H_{A,1}: \mu_{A,High} \neq \mu_{A,Low} 
H_{A,2}: \mu_{R,High} \neq \mu_{R,Low}
$$

Both tests will use independent-samples Welch’s *t*-test.

# Potential Challenges

Although the dataset has been cleaned and extreme outliers removed to make the exploratory analysis more meaningful, several limitations and potential challenges remain.

**Non-linear relationships**  
Some predictors (e.g., `accommodates` or `review_scores_rating`) may have non-linear relationships with `price`. A linear model assumes straight-line relationships; if violated, the regression may understate or overstate these effects.

**Selection bias due to filtering**  
To focus on active listings with meaningful review data, we removed all observations with zero monthly reviews or zero review scores. This necessarily excludes new, inactive, or unrated listings. As a result, the final dataset overrepresents established listings with a track record of guest activity. 

**Multicollinearity**  
Predictors such as `accommodates` and `neigh_group` may be correlated (for example, larger properties clustering in certain neighbourhoods). High correlation can inflate standard errors and make it difficult to determine which variable most strongly influences price.

**Potential non-independence**  
Listings managed by the same host or located in the same building could share unobserved traits, violating the independence assumption.

**Missing or unmeasured variables**  
Important factors such as property type, amenities, proximity to downtown, and seasonal trends are not included in this dataset. Their omission limits the model’s ability to fully explain variation in nightly price and may leave residual confounding.

**Impact:**  
These limitations may reduce the precision of coefficient estimates and the generalizability of conclusions. However, verifying model assumptions, using diagnostic plots, and reporting all limitations transparently will help maintain the credibility and interpretability of the results.


## Acknowledgment

OpenAI’s ChatGPT (GPT-5) was used to assist with **R functions, table formatting, and grammar refinement** throughout the document.  

\newpage

**References**

::: {#refs}
:::

\newpage

**Appendix**

**Appendix: Code**

```{r}
#| echo: true
#| eval: false
#| ref-label: !expr all_labels()
```


\newpage

**Appendix**

**Appendix: Part 1 Main Write-Up**

# Part 1: Background and Key Variables

```{r}
#| echo: false
#| label: load Data
airbnb <- read_csv("listings.csv", show_col_types = FALSE)
```

```{r}
#| echo: false
#| results: hide
#| label: check the structure of the dataset
airbnb |> glimpse()
```


## Dataset Introduction

**Inside Airbnb** is an independent, non-commercial project that regularly scrapes and curates public *Airbnb* listing data to support community and policy discussions. The Toronto snapshot used here is the `listings.csv` file compiled on **September 11, 2025** [@inside_airbnb], containing detailed information on each active Airbnb listing in the city. 

This dataset is relevant to several policy and research areas:

- **Housing Affordability:** Advocacy groups use it to examine whether **short-term rentals (STRs)** reduce long-term rental supply and put upward pressure on rents [@fairbnb_canada].
- **Economic Impact:** It helps gauge STR activity within the city’s tourism market.
- **Policy and Regulation:** It supports monitoring compliance with the City of Toronto’s principal-residence short-term rental bylaw [@toronto_str_bylaw].

## Variable Descriptions

We focus on nightly price as the primary outcome of interest (response variable **Y**) and a set of listing attributes as predictors (**X**). 


```{r}
#| label: tbl-vars
#| tbl-cap: "Variable"
#| echo: false
#| warning: false
#| message: false

var_dict <- tribble(
  ~variable,                ~meaning,                                   ~units,        ~type,                 ~role,
  "price_num",              "Nightly price (numeric)",                  "CAD/night",   "quant. (cont.)",      "Y",
  "neighbourhood_cleansed", "Official Toronto neighbourhood (~140)",    "—",           "cat. (nom.; high-card.)","X",
  "room_type",              "Type of accommodation",                    "—",           "cat. (nom.)",         "X",
  "accommodates",           "Max guests accommodated",                  "people",      "quant. (disc.)",      "X",
  "minimum_nights",         "Minimum stay length (host-set)",           "nights",      "quant. (disc.)",      "X",
  "availability_365",       "Days available in next 365 days",          "days",        "quant. (disc.)",      "X",
  "number_of_reviews",      "Total reviews (popularity proxy)",         "count",       "quant. (disc.)",      "X",
  "reviews_per_month",      "Average monthly reviews (activity proxy)", "count/month", "quant. (cont.)",      "X",
  "review_scores_rating",   "Overall rating (0–100)",                   "score",       "quant. (near-cont.)", "X",
  "host_is_superhost",      "Superhost status flag",                    "—",           "bin. cat.",           "X"
)

var_dict |>
  kable(
    col.names = c("Variable", "Meaning", "Units", "Type", "Role (Y/X)"),
    align = c("l","l","c","l","c"),
    booktabs = TRUE,
    escape = FALSE
  ) |>
  kable_styling(
    latex_options = c("hold_position", "scale_down"),
    font_size = 8.5
  ) |>
  kableExtra::column_spec(1, width = "3.0cm") |>
  kableExtra::column_spec(2, width = "6.0cm") |>
  kableExtra::column_spec(3, width = "1.7cm") |>
  kableExtra::column_spec(4, width = "3.0cm") |>
  kableExtra::column_spec(5, width = "2.0cm")
```

**Notes:**

- `number_of_reviews` is used as a proxy for listing popularity.

- `reviews_per_month` is used as a proxy for listing activity / recency.

- `review_scores_rating` is the overall guest rating (0–100), derived from the 0–5 star system (×20), and is only available for listings with reviews.

- `availability_365` can also be analyzed as a response (Y) when studying factors related to listing availability.


## Research Context

```{r}
#| echo: false
#| results: hide
#| label: count-listings
listing_count <- nrow(airbnb)
```


### Suitability for Linear Regression

The dataset meets the prerequisites for linear regression analysis:

- **Quantitative Response Variable:** The primary response `price` is a quantitative, continuous measure, making it suitable as the dependent variable (Y) in a linear model. (Alternatively, other quantitative outcomes like `availability_365` or `reviews_per_month` could be examined.)

- **Mix of Predictors:** We have a rich mix of predictor (X) variables, including:
    * **Quantitative:** `accommodates`, `minimum_nights`, `number_of_reviews`, etc.
    * **Categorical:** `neighbourhood_cleansed`, `room_type`, `host_is_superhost`.
    
- **Large Sample Size:** The dataset includes a large number of observations (n = `r listing_count`), providing sufficient statistical power for models with multiple predictors and helping satisfy linear regression assumptions.

- **Independence:** We assume each listing is an independent observation. While some hosts may own multiple properties, we consider this independence assumption reasonable for the scope of our project.


### Potential Research Questions

Our analysis will be guided by a primary research question supported by secondary questions and a specific hypothesis test.

* **Primary Regression Question:** Which factors are the key drivers of nightly `price`? For example, how do `room_type`, `accommodates`, and `neighbourhood_cleansed` contribute to price differences? (This will likely be modeled as `log(price)` to handle skew).

* **Supporting Regression Question:** Is there a location-driven price premium? That is, do some neighbourhoods remain significantly more expensive even after controlling for key listing features like room type and capacity?

* **Anticipated Hypothesis Test (Example):**
As required by the project, we will conduct at least one hypothesis test in addition to the regression analysis. An example is a two-sample t-test:

    * **$H_0$**: The mean nightly `log(price)` for "Entire home/apt" listings is equal to the mean nightly `log(price)` for "Private room" listings.
    * **$H_a$**: The mean nightly `log(price)` for these two room types is different.


## Data Quality Considerations

```{r}
#| label: dq-clean
#| include: false

airbnb <- airbnb |>
  mutate(
    price_num = parse_number(as.character(price)),
    minimum_nights = parse_number(as.character(minimum_nights)),
    flag_min_nights_gt365 = minimum_nights > 365
  )
```

### Missing Values

```{r}
#| echo: false
#| label: check missing values
#| results: hide

key_vars <- c("price_num", "neighbourhood_cleansed", "room_type", 
              "accommodates", "minimum_nights", "availability_365",
              "number_of_reviews", "reviews_per_month", 
              "review_scores_rating", "host_is_superhost", "host_name")

airbnb |> select(any_of(key_vars)) |>
  map(~ sum(is.na(.x))) |>
  unlist() |>
  enframe() 
```

A preliminary review shows that missingness is concentrated in the price and review-related variables: `price_num` is missing for 5,625 listings, `reviews_per_month` and `review_scores_rating` are each missing for 4,810 listings, and `host_is_superhost` is missing for 837 listings. The other core variables are essentially complete. 

Because price is the main response variable for this project, we will conduct price-based modelling on the subset of listings with a valid numeric price.

The missing review-related fields largely reflect listings that have not received any reviews yet, so `reviews_per_month` can, where appropriate, be treated as 0.


### Outliers and Extreme Values
```{r}
#| echo: false
#| results: hide
#| label: Check for Outliers

summary(airbnb$price_num)
summary(airbnb$minimum_nights)
```

A preliminary check for outliers shows that both price and minimum stay length exhibit clear right-skewness and a few extreme values.

For `price_num`, the median is about 135 CAD but a few listings are priced as high as **16,203** CAD, which is far above the typical range and should be regarded as a high-end or potentially anomalous observation.

The pattern is similar for `minimum_nights`: the median is only 8 nights, but the maximum reaches **1,125** nights, which is clearly beyond what is reasonable for short-term rentals. 

Before modelling, we can consider applying a log transformation to price, and capping or excluding the extremely large minimum-stay values. 


### Planned Data Cleaning Steps

Based on the initial data review, we plan to perform the following cleaning steps before analysis:

1.  Use only listings with a valid numeric `price_num` when running price-based models.

2. Impute `reviews_per_month = 0` for listings with `number_of_reviews = 0`.

3. Convert key categorical fields (`neighbourhood_cleansed`, `room_type`, `host_is_superhost`) to proper categorical (factor) data types in R.

4. Devise a strategy (e.g., log-transformation or winsorization) to handle extreme outliers in `price_num` and `minimum_nights` so they do not unduly influence the results.


